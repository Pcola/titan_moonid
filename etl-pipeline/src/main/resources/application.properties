# ===========================================
# ETL Pipeline Configuration
# ===========================================

spring.application.name=etl-pipeline

# Import .env suboru
spring.config.import=optional:file:.env[.properties]

# Database
spring.datasource.url=jdbc:postgresql://localhost:5432/titan_moonid
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.hikari.maximum-pool-size=10

# Flyway
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true

# Logging
logging.level.sk.pcola.etl=DEBUG
logging.level.org.springframework.jdbc=DEBUG

# ===========================================
# HUMED Feed Configuration
# ===========================================
etl.humed.feed-url=https://www.partner.humed.sk/index.php?route=extension/feed/feedperuser&customer_id=999
etl.humed.feed-path=${HUMED_FEED_PATH:/tmp/humed_feed.xml}
etl.humed.enabled=true

# ===========================================
# Scheduler Configuration
# ===========================================
# HUMED: denne o 02:00
etl.scheduler.humed-cron=0 0 2 * * *
# Corwell produkty: denne o 02:30
etl.scheduler.corwell-products-cron=0 30 2 * * *
# Corwell zasoby: kazdu hodinu
etl.scheduler.corwell-stock-cron=0 0 * * * *

spring.task.scheduling.pool.size=2


# ===================================================
# Gemini API Configuration
# ===================================================

# API Key - získaj z https://aistudio.google.com/app/apikey
# NIKDY necommituj API key do git repozitára!
gemini.api.key=${GEMINI_API_KEY}

# Model - gemini-2.5-flash je najlepší pomer cena/výkon
gemini.model=gemini-2.5-flash

# Rate limiting
# Free tier: 60 requests/minute
# Paid tier: 1000+ requests/minute
gemini.rate.limit.delay.ms=1100

# Retry configuration
gemini.max.retries=3
gemini.retry.backoff.multiplier=2

# Timeouts
gemini.connect.timeout.seconds=30
gemini.read.timeout.seconds=120

# Batch processing
gemini.batch.size=50
gemini.batch.output.path=./batch_requests.jsonl

# ===================================================
# Manufacturer Enrichment Configuration
# ===================================================
# Vyhľadávanie EAN a produktových dát z oficiálnych stránok výrobcov

# Zapnúť/vypnúť enrichment (true/false)
gemini.enrichment.enabled=true

# Rate limit pre enrichment API calls (ms medzi requestmi)
# Odporúčané: 1500ms pre free tier (40 req/min max)
gemini.enrichment.rate.limit.ms=1500

# Minimálny confidence score pre akceptovanie EAN
# 0.7 = prijmeme dáta s vysokou spoľahlivosťou
gemini.enrichment.min.confidence=0.7


# ===================================================
# Vertex AI Configuration (alternatíva pre Google Cloud)
# ===================================================

# Project ID - z Google Cloud Console
# vertex.ai.project.id=${GOOGLE_CLOUD_PROJECT:}

# Location - odporúčaná europe-west1 pre EU dáta
# vertex.ai.location=europe-west1

# ===================================================
# POZNÁMKY
# ===================================================
#
# 1. Pre produkčné použitie odporúčam Vertex AI namiesto Gemini API:
#    - Lepšie SLA
#    - Enterprise support
#    - EU data residency
#
# 2. Ceny (január 2026):
#    - gemini-2.5-flash: $0.075/1M input tokens, $0.30/1M output tokens
#    - Batch API: 50% zľava
#
# 3. Pre 1500 produktov očakávané náklady:
#    - ~500 tokens/produkt (input + output)
#    - ~750K tokens celkom
#    - ~$0.30 (sync) alebo ~$0.15 (batch)
#
# 4. Nastav API key ako environment variable:
#    export GEMINI_API_KEY=your-api-key-here
#    java -jar etl-pipeline.jar --optimize
